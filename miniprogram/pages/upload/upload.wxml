<!--upload.wxml-->
<view class="page">
  <!-- 页面标题 -->
  <view class="page-header">
    <text class="page-title">文件上传</text>
    <text class="page-subtitle">选择您要打印的文件</text>
  </view>

  <view class="content">
    <!-- 上传区域 -->
    <view class="upload-section">
      <view class="upload-area" bindtap="chooseFile">
        <view class="upload-content" wx:if="{{!fileInfo}}">
          <view class="upload-icon-wrapper">
            <view class="upload-icon">
              <text class="upload-emoji">📁</text>
            </view>
          </view>
          <text class="upload-text">点击选择文件</text>
          <text class="upload-desc">支持PDF、Word、Excel、PPT、图片等格式</text>
          <text class="upload-limit">文件大小不超过50MB</text>
        </view>

        <!-- 文件信息 -->
        <view class="file-info" wx:if="{{fileInfo}}">
          <view class="file-header">
            <view class="file-icon-wrapper">
              <view class="file-icon">
                <text class="file-emoji">{{getFileIcon(fileInfo.type)}}</text>
              </view>
            </view>
            <view class="file-details">
              <text class="file-name">{{fileInfo.name}}</text>
              <view class="file-meta">
                <text class="file-size">{{formatFileSize(fileInfo.size)}}</text>
                <text class="file-type">{{getFileTypeName(fileInfo.type)}}</text>
              </view>
            </view>
          </view>
          <view class="file-actions">
            <button class="action-btn secondary" bindtap="removeFile">
              <text class="btn-text">删除</text>
            </button>
            <button class="action-btn primary" bindtap="chooseFile">
              <text class="btn-text">重选</text>
            </button>
          </view>
        </view>
      </view>
    </view>

    <!-- 上传进度 -->
    <view class="upload-progress-section" wx:if="{{uploading}}">
      <view class="progress-card">
        <view class="progress-header">
          <text class="progress-title">正在上传文件...</text>
          <text class="progress-percent">{{uploadProgress}}%</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{uploadProgress}}%"></view>
        </view>
        <text class="progress-tip">请耐心等待，不要关闭页面</text>
      </view>
    </view>

    <!-- 文件预览 -->
    <view class="file-preview-section" wx:if="{{fileInfo && fileInfo.uploaded}}">
      <view class="preview-card">
        <view class="preview-header">
          <text class="preview-title">文件信息</text>
          <view class="page-info" wx:if="{{fileInfo.pageCount}}">
            <text class="page-count">共 {{fileInfo.pageCount}} 页</text>
          </view>
        </view>

        <!-- 图片预览 -->
        <view class="image-preview" wx:if="{{isImageFile(fileInfo.type)}}">
          <image src="{{fileInfo.url}}" mode="aspectFit" class="preview-image"></image>
        </view>

        <!-- PDF预览 -->
        <view class="pdf-preview" wx:if="{{isPdfFile(fileInfo.type)}}">
          <view class="preview-placeholder">
            <text class="placeholder-icon">📄</text>
            <text class="placeholder-text">PDF文件已准备就绪</text>
            <text class="placeholder-desc">点击下一步进行打印配置</text>
          </view>
        </view>

        <!-- 其他文件类型 -->
        <view class="other-preview" wx:if="{{!isImageFile(fileInfo.type) && !isPdfFile(fileInfo.type)}}">
          <view class="preview-placeholder">
            <text class="placeholder-icon">📄</text>
            <text class="placeholder-text">文件已准备就绪</text>
            <text class="placeholder-desc">点击下一步进行打印配置</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="action-buttons" wx:if="{{fileInfo && fileInfo.uploaded}}">
      <button class="btn secondary" bindtap="goBack">
        <text class="btn-text">返回首页</text>
      </button>
      <button class="btn primary" bindtap="goToConfig">
        <text class="btn-text">下一步：打印设置</text>
      </button>
    </view>
  </view>

  <!-- 支持的文件格式说明 -->
  <view class="file-formats-section">
    <view class="formats-card">
      <view class="formats-header">
        <text class="formats-title">支持的文件格式</text>
      </view>
      <view class="formats-grid">
        <view class="format-item">
          <view class="format-icon">📄</view>
          <text class="format-name">PDF</text>
          <text class="format-desc">便携文档</text>
        </view>
        <view class="format-item">
          <view class="format-icon">📝</view>
          <text class="format-name">Word</text>
          <text class="format-desc">文档文件</text>
        </view>
        <view class="format-item">
          <view class="format-icon">📊</view>
          <text class="format-name">Excel</text>
          <text class="format-desc">电子表格</text>
        </view>
        <view class="format-item">
          <view class="format-icon">📋</view>
          <text class="format-name">PPT</text>
          <text class="format-desc">演示文稿</text>
        </view>
        <view class="format-item">
          <view class="format-icon">🖼️</view>
          <text class="format-name">图片</text>
          <text class="format-desc">JPG/PNG</text>
        </view>
        <view class="format-item">
          <view class="format-icon">📄</view>
          <text class="format-name">TXT</text>
          <text class="format-desc">文本文件</text>
        </view>
      </view>
      <view class="formats-note">
        <text class="note-text">💡 文件大小限制：50MB以内</text>
      </view>
    </view>
  </view>
</view>
