<!--upload.wxml-->
<view class="page">
  <view class="content">
    <!-- 上传区域 -->
    <view class="upload-area" bindtap="chooseFile">
      <view class="upload-content" wx:if="{{!fileInfo}}">
        <view class="upload-icon">📁</view>
        <text class="upload-text">点击选择文件</text>
        <text class="upload-desc">支持PDF、Word、Excel、图片等格式</text>
      </view>
      
      <!-- 文件信息 -->
      <view class="file-info" wx:if="{{fileInfo}}">
        <view class="file-icon">
          <text>{{getFileIcon(fileInfo.type)}}</text>
        </view>
        <view class="file-details">
          <text class="file-name">{{fileInfo.name}}</text>
          <text class="file-size">{{formatFileSize(fileInfo.size)}}</text>
          <text class="file-type">{{fileInfo.type}}</text>
        </view>
        <view class="file-actions">
          <text class="action-btn" bindtap="removeFile">删除</text>
          <text class="action-btn" bindtap="chooseFile">重选</text>
        </view>
      </view>
    </view>

    <!-- 上传进度 -->
    <view class="upload-progress" wx:if="{{uploading}}">
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{uploadProgress}}%"></view>
      </view>
      <text class="progress-text">上传中... {{uploadProgress}}%</text>
    </view>

    <!-- 文件预览 -->
    <view class="file-preview" wx:if="{{fileInfo && fileInfo.uploaded}}">
      <view class="preview-header">
        <text class="preview-title">文件预览</text>
        <text class="page-count" wx:if="{{fileInfo.pageCount}}">共{{fileInfo.pageCount}}页</text>
      </view>
      
      <!-- 图片预览 -->
      <view class="image-preview" wx:if="{{isImageFile(fileInfo.type)}}">
        <image src="{{fileInfo.url}}" mode="aspectFit" class="preview-image"></image>
      </view>
      
      <!-- PDF预览 -->
      <view class="pdf-preview" wx:if="{{isPdfFile(fileInfo.type)}}">
        <text class="preview-tip">PDF文件预览功能开发中...</text>
      </view>
      
      <!-- 其他文件类型 -->
      <view class="other-preview" wx:if="{{!isImageFile(fileInfo.type) && !isPdfFile(fileInfo.type)}}">
        <text class="preview-tip">该文件类型暂不支持预览</text>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="action-buttons" wx:if="{{fileInfo && fileInfo.uploaded}}">
      <button class="btn-secondary" bindtap="goBack">返回</button>
      <button class="btn-primary" bindtap="goToConfig">下一步</button>
    </view>
  </view>

  <!-- 支持的文件格式说明 -->
  <view class="file-formats">
    <view class="formats-title">支持的文件格式：</view>
    <view class="formats-list">
      <view class="format-item">
        <text class="format-icon">📄</text>
        <text class="format-name">PDF</text>
      </view>
      <view class="format-item">
        <text class="format-icon">📝</text>
        <text class="format-name">Word</text>
      </view>
      <view class="format-item">
        <text class="format-icon">📊</text>
        <text class="format-name">Excel</text>
      </view>
      <view class="format-item">
        <text class="format-icon">🖼️</text>
        <text class="format-name">图片</text>
      </view>
    </view>
  </view>
</view>
